.modal.svelte-9zy1a5{position:fixed;z-index:5000;top:0;height:100vh;width:100vw;justify-content:center;align-items:center;display:flex;opacity:0;background-color:#000000dd;visibility:hidden;transition:visibility 0s, opacity 0.25s ease-out}.modal.show{visibility:visible;opacity:1.0}.container.svelte-9zy1a5{width:max-content;max-width:100vw}
.canvas-container.svelte-jpbj{width:100%;height:calc(100vh - 2.85rem);overflow-y:hidden;background-color:#2D3343}.canvas.svelte-jpbj{}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguMTc1NDcyYjkuY3NzIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcG9uZW50cy9Nb2RhbC5zdmVsdGUiLCIuLi8uLi8uLi9zcmMvcm91dGVzL21hcC9pbmRleC5zdmVsdGUiXSwic291cmNlc0NvbnRlbnQiOlsiPGRpdiBjbGFzcz1cIm1vZGFsXCIgYmluZDp0aGlzPXtlbH0gb246a2V5ZG93bj17b25rZXlkb3dufSBvbjptb3VzZWRvd249e29ubW91c2Vkb3dufSBvbjp0b3VjaHN0YXJ0PXtvbnRvdWNoc3RhcnR9PlxuICA8ZGl2IGNsYXNzPVwicmVsYXRpdmUgY29udGFpbmVyXCIgYmluZDp0aGlzPXtpbm5lcl9lbH0+XG4gICAgPGJ1dHRvbiBjbGFzcz1cImFic29sdXRlIHJpZ2h0LTAgdG9wLTAgYmctYmxhY2sgdGV4dC13aGl0ZSBvcGFjaXR5LTc1IHctNlwiIG9uOmNsaWNrPXtvbmNsaWNrfT5YPC9idXR0b24+XG4gICAgPHNsb3Q+PC9zbG90PlxuICA8L2Rpdj5cbjwvZGl2PlxuXG48c3R5bGU+XG4gIC5tb2RhbCB7XG4gICAgcG9zaXRpb246IGZpeGVkO1xuICAgIHotaW5kZXg6IDUwMDA7XG4gICAgdG9wOiAwO1xuICAgIGhlaWdodDogMTAwdmg7XG4gICAgd2lkdGg6IDEwMHZ3O1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBvcGFjaXR5OiAwO1xuICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDAwMDBkZDtcbiAgICB2aXNpYmlsaXR5OiBoaWRkZW47XG4gICAgdHJhbnNpdGlvbjogdmlzaWJpbGl0eSAwcywgb3BhY2l0eSAwLjI1cyBlYXNlLW91dDtcbiAgfVxuICA6Z2xvYmFsKC5tb2RhbC5zaG93KSB7XG4gICAgdmlzaWJpbGl0eTogdmlzaWJsZTtcbiAgICBvcGFjaXR5OiAxLjA7XG4gIH1cbiAgLmNvbnRhaW5lciB7XG4gICAgd2lkdGg6IG1heC1jb250ZW50O1xuICAgIG1heC13aWR0aDogMTAwdnc7XG4gIH1cbjwvc3R5bGU+XG5cbjxzY3JpcHQgY29udGV4dD1cIm1vZHVsZVwiPlxuICBsZXQgZWxlbWVudHMgPSB7fSxcbiAgICAgIG5leHRfaWQgPSAwO1xuICBleHBvcnQgZnVuY3Rpb24gc2hvdyhpZCkge1xuICAgIGVsZW1lbnRzW2lkXS5jbGFzc0xpc3QuYWRkKFwic2hvd1wiKTtcbiAgfVxuICBleHBvcnQgZnVuY3Rpb24gaGlkZShpZCkge1xuICAgIGVsZW1lbnRzW2lkXS5jbGFzc0xpc3QucmVtb3ZlKFwic2hvd1wiKTtcbiAgfVxuPC9zY3JpcHQ+XG5cbjxzY3JpcHQ+XG5cdGltcG9ydCB7IG9uTW91bnQsIG9uRGVzdHJveSB9IGZyb20gJ3N2ZWx0ZSc7XG4gIGxldCBpZCA9IG5leHRfaWQrKztcbiAgbGV0IGVsLCBpbm5lcl9lbDtcbiAgZnVuY3Rpb24gb250b3VjaHN0YXJ0KGUpe1xuICAgIGUucGFnZVggPSBlLnRvdWNoZXNbMF0ucGFnZVg7XG4gICAgZS5wYWdlWSA9IGUudG91Y2hlc1swXS5wYWdlWTtcbiAgICByZXR1cm4gb25tb3VzZWRvd24oZSk7XG4gIH1cbiAgZnVuY3Rpb24gb25tb3VzZWRvd24oZSl7XG4gICAgbGV0IHggPSBlLnBhZ2VYLFxuICAgICAgeSA9IGUucGFnZVksXG4gICAgICByID0gaW5uZXJfZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc29sZS5sb2coeCwgci54LCByLndpZHRoKVxuICAgIGlmKHggPCByLnggfHwgeCA+IHIueCArIHIud2lkdGggfHwgeSA8IHIueSB8fCB5ID4gci55K3IuaGVpZ2h0KVxuICAgICAgaGlkZShpZCk7XG4gIH1cbiAgZnVuY3Rpb24gb25jbGljayhlKXtcbiAgICBoaWRlKGlkKTtcbiAgfVxuICBmdW5jdGlvbiBvbmtleWRvd24oZSl7XG4gICAgaWYoZS5rZXlDb2RlID09IDI3KXtcbiAgICAgIGhpZGUoaWQpO1xuICAgIH1cbiAgfVxuICBvbk1vdW50KGFzeW5jICgpPT57XG4gICAgZWxlbWVudHNbaWRdID0gZWw7XG4gIH0pO1xuICBvbkRlc3Ryb3koKCk9PntcbiAgICBlbGVtZW50c1tpZF0gPSB1bmRlZmluZWQ7XG4gIH0pO1xuPC9zY3JpcHQ+XG4iLCI8c3ZlbHRlOmhlYWQ+XG5cdDx0aXRsZT7tirjsiJhnZyAtIOyKpO2KuOumrOuouCDsp4Drj4Q8L3RpdGxlPlxuPC9zdmVsdGU6aGVhZD5cblxuPE1vZGFsPlxuICA8ZGl2IGNsYXNzPVwicC02IGZsZXggZmxleC1jb2wgYmctZ3JheS0yMDAgdGV4dC1ncmF5LTYwMFwiPlxuICAgIDxkaXYgY2xhc3M9XCJwdC0yXCI+IOyhsOyekeuylSA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwidGV4dC1zbSBwbC0yXCI+XG4gICAgICA8ZGl2PlxuICAgICAgICA8c3ZnIGFyZWEtaGlkZGVuPVwidHJ1ZVwiIHJvbGU9XCJpbWdcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCB7ZmFNb3VzZS5pY29uWzBdfSB7ZmFNb3VzZS5pY29uWzFdfVwiIGNsYXNzPVwidy0zIGgtMyBtci0xIG92ZXJmbG93LXZpc2libGUgaW5saW5lLWJsb2NrXCI+XG4gICAgICAgICAgPHBhdGggZmlsbD1cImN1cnJlbnRDb2xvclwiIGQ9XCJ7ZmFNb3VzZS5pY29uWzRdfVwiLz5cbiAgICAgICAgPC9zdmc+XG4gICAgICAgIO2coC/rk5zrnpjqt7gv642U67iU7YG066atXG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXY+XG4gICAgICAgIDxzdmcgYXJlYS1oaWRkZW49XCJ0cnVlXCIgcm9sZT1cImltZ1wiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB2aWV3Qm94PVwiMCAwIHtmYU1vYmlsZUFsdC5pY29uWzBdfSB7ZmFNb2JpbGVBbHQuaWNvblsxXX1cIiBjbGFzcz1cInctMyBoLTMgbXItMSBvdmVyZmxvdy12aXNpYmxlIGlubGluZS1ibG9ja1wiPlxuICAgICAgICAgIDxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwie2ZhTW9iaWxlQWx0Lmljb25bNF19XCIvPlxuICAgICAgICA8L3N2Zz5cbiAgICAgICAg7ZmV64yALOuTnOuemOq3uOygnOyKpOyymC/rjZTruJTtg61cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJwdC0yXCI+IOqwnOyalCA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwidGV4dC1zbSBwbC0yXCI+XG4gICAgICA8ZGl2PlxuICAgICAgICAtIO2DgOydvCDtlZwg7Lm47J2AIOyKpO2KuOumrOuouCDtlZwg66qF7J2EIOydmOuvuO2VqeuLiOuLpC5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdj5cbiAgICAgICAgLSDqsbDrpqzqsIAg6rCA6rmM7Jq0IOyKpO2KuOumrOuouOuKlCDshJzroZwg67mE7Iq37ZWgIO2ZleuloOydtCDrhpLsirXri4jri6QuXG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXY+XG4gICAgICAgIC0g7Jyg7J2Y66+47ZWY6rKMIOu5hOyKt+2VnCDsiqTtirjrpqzrqLgg7KeR64uo7J2AIOq1reqwgOuhnCDqtazrtoTsp4DslrQg7ZGc7Iuc65Cp64uI64ukLlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2PlxuICAgICAgICAtIOq1reqwgOydmCDsnbTrpoTsnYAg6rWt6rCAIOyghOyytOydmCDshLHqsqnsnYQg6rCA7J6lIOyemCDrgpjtg4DrgrTripQg7Iqk7Yq466as66i47J2YIOydtOumhOycvOuhnCDtkZzsi5zrkKnri4jri6QuXG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXY+XG4gICAgICAgIC0g6rWt6rCA7JeQIO2PrO2VqOuQmOyngCDslYrsnYAg7Iqk7Yq466as66i464qUIOu2hOyfgeyngOyXreydtOqxsOuCmCDrj4Tsi5zqta3qsIDsnoXri4jri6QuXG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXY+XG4gICAgICAgIC0g7KeA64+E7J2YIO2Yle2DnOyZgCDsiqTtirjrpqzrqLjrk6TsnZgg7JyE7LmY64qUIOqzhOyCsCDqsrDqs7zsl5Ag65Sw6528IOyImOyLnOuhnCDrsJTrgJTsiJjsnojsirXri4jri6QuXG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwicHQtMlwiPiDrspTroYAgPC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cInRleHQtc20gcGwtMlwiPlxuICAgICAgPGRpdiBjbGFzcz1cImFsaWduLW1pZGRsZSBtYi0xXCI+XG4gICAgICAgIHsjaWYgc3ByaXRlcy50b3duX25pZ2h0fSBcbiAgICAgICAgICA8aW1nIHNyYz1cIntzcHJpdGVzLnRvd25fbmlnaHQuc3JjfVwiIGNsYXNzPVwidy02IGgtNiBpbmxpbmVcIi8+XG4gICAgICAgIHsvaWZ9XG4gICAgICAgIDEwMOuUsOumrFxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiYWxpZ24tbWlkZGxlIG1iLTFcIj5cbiAgICAgICAgeyNpZiBzcHJpdGVzLmNhc3RsZV9uaWdodH0gXG4gICAgICAgICAgPGltZyBzcmM9XCJ7c3ByaXRlcy5jYXN0bGVfbmlnaHQuc3JjfVwiIGNsYXNzPVwidy02IGgtNiBpbmxpbmVcIi8+XG4gICAgICAgIHsvaWZ9XG4gICAgICAgIDEwMDDrlLDrpqxcbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImFsaWduLW1pZGRsZSBtYi0xXCI+XG4gICAgICAgIHsjaWYgc3ByaXRlcy5jaXR5X25pZ2h0fSBcbiAgICAgICAgICA8aW1nIHNyYz1cIntzcHJpdGVzLmNpdHlfbmlnaHQuc3JjfVwiIGNsYXNzPVwidy02IGgtNiBpbmxpbmVcIi8+XG4gICAgICAgIHsvaWZ9XG4gICAgICAgIDEwMDAw65Sw66asXG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJtYi0xXCI+XG4gICAgICAgIHsjaWYgc3ByaXRlcy50b3duICYmIHNwcml0ZXMuY2FzdGxlICYmIHNwcml0ZXMuY2l0eX0gXG4gICAgICAgICAgPGltZyBzcmM9XCJ7c3ByaXRlcy50b3duLnNyY31cIiBjbGFzcz1cInctNiBoLTYgaW5saW5lXCIvPlxuICAgICAgICAgIDxpbWcgc3JjPVwie3Nwcml0ZXMuY2FzdGxlLnNyY31cIiBjbGFzcz1cInctNiBoLTYgaW5saW5lXCIvPlxuICAgICAgICAgIDxpbWcgc3JjPVwie3Nwcml0ZXMuY2l0eS5zcmN9XCIgY2xhc3M9XCJ3LTYgaC02IGlubGluZVwiLz5cbiAgICAgICAgey9pZn1cbiAgICAgICAg67Cp7Iah7KSRXG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJhbGlnbi1taWRkbGUgbWItMVwiPlxuICAgICAgICB7I2lmIHNwcml0ZXMuZmlyZX0gXG4gICAgICAgICAgPGltZyBzcmM9XCJ7c3ByaXRlcy5maXJlLnNyY31cIiBjbGFzcz1cInctNiBoLTYgaW5saW5lXCIvPlxuICAgICAgICB7L2lmfVxuICAgICAgICDssYTtjIXssL0g67aI64KoXG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG4gIFxuPC9Nb2RhbD5cblxuPGRpdlxuICAgIG9uOm1vdXNlZG93bj17Y2FudmFzX21vdXNlX2Rvd259XG4gICAgb246bW91c2V1cD17Y2FudmFzX21vdXNlX3VwfVxuICAgIG9uOm1vdXNlbW92ZT17Y2FudmFzX21vdXNlX21vdmV9XG4gICAgb246bW91c2VsZWF2ZT17Y2FudmFzX21vdXNlX291dH1cbiAgICBvbjp3aGVlbD17Y2FudmFzX3Njcm9sbH1cbiAgICBvbjp0b3VjaHN0YXJ0PXtjYW52YXNfdG91Y2hfc3RhcnR9XG4gICAgb246dG91Y2htb3ZlPXtjYW52YXNfdG91Y2hfbW92ZX1cbiAgPlxuPGRpdiBjbGFzcz1cImZpeGVkIHAtNiB0ZXh0LXdoaXRlIG1kOmJsb2NrIGZsZXggZmxleC1yb3cganVzdGlmeS1iZXR3ZWVuIHctZnVsbCBtZDp3LWF1dG9cIj5cbiAgPGRpdj5cbiAgICA8aDIgY2xhc3M9XCJpbmxpbmUtYmxvY2sgdGV4dC0yeGwgbWQ6dGV4dC0zeGxcIj5cbiAgICAgIOyKpO2KuOumrOuouCDsp4Drj4RcbiAgICA8L2gyPlxuICAgIDxUaXAgY2xpY2s9e3RpcF9jbGlja30+XG4gICAgICA8c3BhbiBzbG90PVwidGlwXCI+IO2BtOumre2VmOyXrCDshKTrqoXsl7TquLA8L3NwYW4+XG4gICAgPC9UaXA+XG4gIDwvZGl2PiBcbiAgPFN0cmVhbWVyQXV0b0NvbXBsZXRlIHN0cmVhbWVycz17c3RyZWFtZXJzfSBiaW5kOnNlbGVjdGVkPXtzZWFyY2h9IHBsYWNlaG9sZGVyPVwi7KeA64+E7JeQ7IScIOywvuq4sFwiIGlucHV0X2NsYXNzPVwiYmctdHJhbnNwYXJlbnQgYm9yZGVyIGJvcmRlci13aGl0ZSB0ZXh0LXNtIG1kOnctNDAgdy0zMiBwLTIgbWQ6bXQtNCBwbGFjZWhvbGRlci13aGl0ZSBmb2N1czpiZy1ncmF5LTYwMCB0cmFuc2l0aW9uLWFsbCB0cmFuc2l0aW9uLTEwMFwiIGljb249ZmFsc2UgaWQ9XCJzdHJlYW1lci1tYXBcIi8+XG48L2Rpdj5cbjxkaXYgY2xhc3M9XCJvdmVyZmxvdy14LWF1dG8gY2FudmFzLWNvbnRhaW5lclwiPlxuICA8Y2FudmFzIGJpbmQ6dGhpcz17Y2FudmFzfSBjbGFzcz1cInctZnVsbCBoLWZ1bGwgY2FudmFzXCJcbiAgPiA8L2NhbnZhcz5cbjwvZGl2PlxuPC9kaXY+XG48IS0tXG48ZGl2IGNsYXNzPVwidy1mdWxsIGZsZXggZmxleC1yb3cgZmxleC13cmFwIGl0ZW1zLWNlbnRlclwiPlxuICA8ZGl2IGNsYXNzPVwicC0yIGZsZXggZmxleC1yb3cgZmxleC13cmFwIGl0ZW1zLWNlbnRlclwiPlxuICAgIDxkaXYgY2xhc3M9XCJweC0yXCI+PGlucHV0IHR5cGU9Y2hlY2tib3ggYmluZDpjaGVja2VkPXtjbHVzdGVyaW5nX3Nob3d9IGlkPVwiYm9yZGVyXCIgbmFtZT1cImJvcmRlclwiPiA8bGFiZWwgZm9yPVwiYm9yZGVyXCI+6rWt6rK9PC9sYWJlbD48L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwicHgtMlwiPjxpbnB1dCB0eXBlPWNoZWNrYm94IGJpbmQ6Y2hlY2tlZD17cG90cmFpdF9zaG93fSBpZD1cInBvdHJhaXRcIiBuYW1lPVwicG90cmFpdFwiPiA8bGFiZWwgZm9yPVwicG90cmFpdFwiPuy0iOyDge2ZlDwvbGFiZWw+PC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cInB4LTJcIj48aW5wdXQgdHlwZT1jaGVja2JveCBiaW5kOmNoZWNrZWQ9e25hbWVfc2hvd30gaWQ9XCJuYW1lXCIgbmFtZT1cIm5hbWVcIj4gPGxhYmVsIGZvcj1cIm5hbWVcIj7snbTrpoQ8L2xhYmVsPjwvZGl2PlxuICA8L2Rpdj5cbjwvZGl2Pi0tPlxuXG48c3R5bGU+XG4uY2FudmFzLWNvbnRhaW5lciB7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IGNhbGMoMTAwdmggLSAyLjg1cmVtKTtcbiAgb3ZlcmZsb3cteTogaGlkZGVuO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiAjMkQzMzQzO1xuICAvKmJveC1zaGFkb3c6IDBweCAwcHggMXJlbSAjMDAwOyovXG59XG4uY2FudmFzIHtcbiAgLypiYWNrZ3JvdW5kOiB1cmwoL3dhdGVycGF0dGVybi5qcGcpO1xuICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xuICBiYWNrZ3JvdW5kLXNpemU6IDEwMCUgMTAwJTsqL1xufVxuPC9zdHlsZT5cblxuPHNjcmlwdCBjb250ZXh0PVwibW9kdWxlXCI+XG5cdGltcG9ydCB7IEFQSSB9IGZyb20gJy4uLy4uL2FwaS5qcyc7XG4gIGV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcmVsb2FkKHBhZ2UsIHNlc3Npb24pIHtcbiAgICBsZXQgc3RyZWFtZXJzID0gYXdhaXQgQVBJLnN0cmVhbWVyX21hcC5jYWxsKHRoaXMpO1xuICAgIGxldCBpbnRlcmVzdF9zdHJlYW1lciA9IHN0cmVhbWVycy5maW5kKHMgPT4gcy5pZCA9PSBwYWdlLnF1ZXJ5LmludGVyZXN0X3N0cmVhbWVyX2lkKTtcbiAgICByZXR1cm4geyBzdHJlYW1lcnMsIGludGVyZXN0X3N0cmVhbWVyIH07XG4gIH1cbjwvc2NyaXB0PlxuXG48c2NyaXB0PlxuaW1wb3J0IHsgb25Nb3VudCwgb25EZXN0cm95IH0gZnJvbSBcInN2ZWx0ZVwiO1xuaW1wb3J0IFN0cmVhbWVyQXV0b0NvbXBsZXRlIGZyb20gXCIuLi8uLi9jb21wb25lbnRzL1N0cmVhbWVyQXV0b0NvbXBsZXRlLnN2ZWx0ZVwiO1xuaW1wb3J0IFBhbmVsIGZyb20gXCIuLi8uLi9jb21wb25lbnRzL1BhbmVsLnN2ZWx0ZVwiO1xuaW1wb3J0IE1vZGFsLCB7IHNob3csIGhpZGUgfSBmcm9tIFwiLi4vLi4vY29tcG9uZW50cy9Nb2RhbC5zdmVsdGVcIjsgXG5pbXBvcnQgeyBmYU1vdXNlIH0gZnJvbSAnQGZvcnRhd2Vzb21lL2ZyZWUtc29saWQtc3ZnLWljb25zL2ZhTW91c2UnXG5pbXBvcnQgeyBmYU1vYmlsZUFsdCB9IGZyb20gJ0Bmb3J0YXdlc29tZS9mcmVlLXNvbGlkLXN2Zy1pY29ucy9mYU1vYmlsZUFsdCdcbmltcG9ydCBUaXAgZnJvbSAnLi4vLi4vY29tcG9uZW50cy9UaXAuc3ZlbHRlJztcblxuZXhwb3J0IGxldCBzdHJlYW1lcnM7XG5leHBvcnQgbGV0IGludGVyZXN0X3N0cmVhbWVyO1xuXG5mdW5jdGlvbiB0aXBfY2xpY2soKSB7XG4gIHNob3coMCk7XG59XG5cbmNvbnN0IENPTE9SUyA9IHtcbiAgc2VhOiBcIiMyRDMzNDNcIixcbiAgbGFuZDogXCIjODA2QTVDXCIsXG4gIGxvYWQ6IFwiIzNjM2MzM1wiLFxuICBoaWdobGlnaHQ6IFwiI2Q0YWYzN1wiLFxufVxuXG5sZXQgY2FudmFzO1xuXG5sZXQgc2VhcmNoID0gaW50ZXJlc3Rfc3RyZWFtZXI7XG5sZXQgY2x1c3RlcmluZ19zaG93ID0gdHJ1ZTtcbmxldCBwb3RyYWl0X3Nob3cgPSB0cnVlO1xubGV0IG5hbWVfc2hvdyA9IHRydWU7XG5cbmxldCBuID0gTWF0aC5tYXgoLi4uc3RyZWFtZXJzLm1hcChzPT5zLngpLCAuLi5zdHJlYW1lcnMubWFwKHM9PnMueSkpICsgMTtcbmxldCBjYW1lcmEgPSBpbnRlcmVzdF9zdHJlYW1lcj8gXG4gIFtpbnRlcmVzdF9zdHJlYW1lci54L24sIGludGVyZXN0X3N0cmVhbWVyLnkvbiwgMS41XSA6IFxuICBbMC41LCAwLjQ1LCAwLjg1XTtcbmxldCBwaWVjZV9zaXplID0gWzY0LCA2NF07XG5cbmxldCBsYXN0X3BvaW50ZXJfeD1udWxsLCBsYXN0X3BvaW50ZXJfeT1udWxsLCBjbGlja2luZyA9IGZhbHNlO1xuZnVuY3Rpb24gY2FudmFzX21vdXNlX2Rvd24oZSkge1xuICBsYXN0X3BvaW50ZXJfeCA9IGUucGFnZVggLSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkueDtcbiAgbGFzdF9wb2ludGVyX3kgPSBlLnBhZ2VZIC0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnk7XG4gIGNsaWNraW5nID0gdHJ1ZTtcbiAgLy9yZXR1cm4gZS5wcmV2ZW50RGVmYXVsdCgpICYmIGZhbHNlO1xufVxuZnVuY3Rpb24gY2FudmFzX21vdXNlX3VwKGUpIHtcbiAgY2xpY2tpbmcgPSBmYWxzZTtcbiAgLy9yZXR1cm4gZS5wcmV2ZW50RGVmYXVsdCgpICYmIGZhbHNlO1xufVxuZnVuY3Rpb24gY2FudmFzX21vdXNlX291dChlKSB7XG4gIGNsaWNraW5nID0gZmFsc2U7XG59XG5mdW5jdGlvbiBjYW52YXNfbW91c2VfbW92ZShlKSB7XG4gIGxldCBkeCA9IChlLnBhZ2VYIC0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLngpIC0gbGFzdF9wb2ludGVyX3gsXG4gICAgICBkeSA9IChlLnBhZ2VZIC0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnkpIC0gbGFzdF9wb2ludGVyX3k7XG4gIGxhc3RfcG9pbnRlcl94ICs9IGR4O1xuICBsYXN0X3BvaW50ZXJfeSArPSBkeTtcbiAgaWYoIWNsaWNraW5nKSByZXR1cm47XG4gIGNhbWVyYVswXSAtPSBkeCAvIChuICogcGllY2Vfc2l6ZVswXSpjYW1lcmFbMl0pO1xuICBjYW1lcmFbMV0gLT0gZHkgLyAobiAqIHBpZWNlX3NpemVbMV0qY2FtZXJhWzJdKTtcbn1cbmZ1bmN0aW9uIGNhbnZhc19zY3JvbGwoZSkge1xuICBsZXQgZGVsdGEgPSBlLndoZWVsRGVsdGEgPyBlLndoZWVsRGVsdGEgOiBlLmRldGFpbCA/IC0gZS5kZXRhaWwgOiAwO1xuICBjYW1lcmFbMl0gKz0gZGVsdGEgLyBjYW52YXMud2lkdGg7XG4gIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCkgJiYgZmFsc2U7XG59XG5mdW5jdGlvbiBnZXRfZGlzdGFuY2UoZSkge1xuICB2YXIgZGlmZlggPSBlLnRvdWNoZXNbMF0uY2xpZW50WCAtIGUudG91Y2hlc1sxXS5jbGllbnRYO1xuICB2YXIgZGlmZlkgPSBlLnRvdWNoZXNbMF0uY2xpZW50WSAtIGUudG91Y2hlc1sxXS5jbGllbnRZO1xuICByZXR1cm4gTWF0aC5zcXJ0KGRpZmZYICogZGlmZlggKyBkaWZmWSAqIGRpZmZZKTsgLy8gUHl0aGFnb3JlYW4gdGhlb3JlbVxufVxuXG5mdW5jdGlvbiBjYW52YXNfdG91Y2hfc3RhcnQoZSkge1xuICBsZXQgcmVjdCA9IGNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgaWYgKGUudG91Y2hlcy5sZW5ndGggPiAxKSB7IC8vIGlmIG11bHRpcGxlIHRvdWNoZXMgKHBpbmNoIHpvb21pbmcpXG4gICAgZmluZ2VyX2Rpc3QgPSBnZXRfZGlzdGFuY2UoZSk7IC8vIFNhdmUgY3VycmVudCBmaW5nZXIgZGlzdGFuY2VcbiAgfSAvLyBFbHNlIGp1c3QgbW92aW5nIGFyb3VuZFxuICBsYXN0X3BvaW50ZXJfeCA9IGUudG91Y2hlc1swXS5jbGllbnRYIC0gcmVjdC54OyAvLyBTYXZlIGZpbmdlciBwb3NpdGlvblxuICBsYXN0X3BvaW50ZXJfeSA9IGUudG91Y2hlc1swXS5jbGllbnRZIC0gcmVjdC55OyAvL1xuICBpZiAoXCJhY3RpdmVFbGVtZW50XCIgaW4gZG9jdW1lbnQpXG4gICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7XG59O1xuXG5sZXQgZmluZ2VyX2Rpc3Q9MDtcbmZ1bmN0aW9uIGNhbnZhc190b3VjaF9tb3ZlKGUpIHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpOyAvLyBTdG9wIHRoZSB3aW5kb3cgZnJvbSBtb3ZpbmdcbiAgbGV0IHJlY3QgPSBjYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIGlmIChmaW5nZXJfZGlzdCAmJiBlLnRvdWNoZXMubGVuZ3RoID4gMSkgeyAvLyBJZiBwaW5jaC16b29taW5nXG4gICAgbGV0IG5ld19maW5nZXJfZGlzdCA9IGdldF9kaXN0YW5jZShlKTsgLy8gR2V0IGN1cnJlbnQgZGlzdGFuY2UgYmV0d2VlbiBmaW5nZXJzXG4gICAgaWYoZmluZ2VyX2Rpc3QpIGNhbWVyYVsyXSA9IGNhbWVyYVsyXSAqIE1hdGguYWJzKG5ld19maW5nZXJfZGlzdCAvIGZpbmdlcl9kaXN0KTsgLy8gWm9vbSBpcyBwcm9wb3J0aW9uYWwgdG8gY2hhbmdlXG4gICAgZmluZ2VyX2Rpc3QgPSBuZXdfZmluZ2VyX2Rpc3Q7IC8vIFNhdmUgY3VycmVudCBkaXN0YW5jZSBmb3IgbmV4dCB0aW1lXG4gIH0gZWxzZSBpZighZmluZ2VyX2Rpc3QpeyBcbiAgICBsZXQgZHggPSBlLnRvdWNoZXNbMF0uY2xpZW50WCAtIGxhc3RfcG9pbnRlcl94IC0gcmVjdC54LFxuICAgICAgICBkeSA9IGUudG91Y2hlc1swXS5jbGllbnRZIC0gbGFzdF9wb2ludGVyX3kgLSByZWN0Lnk7XG4gICAgbGFzdF9wb2ludGVyX3ggKz0gZHg7XG4gICAgbGFzdF9wb2ludGVyX3kgKz0gZHk7XG4gICAgY2FtZXJhWzBdIC09IGR4IC8gKG4gKiBwaWVjZV9zaXplWzBdKmNhbWVyYVsyXSk7XG4gICAgY2FtZXJhWzFdIC09IGR5IC8gKG4gKiBwaWVjZV9zaXplWzFdKmNhbWVyYVsyXSk7XG4gIH1cbiAgcmV0dXJuIGUucHJldmVudERlZmF1bHQoKSAmJiBmYWxzZTtcbn07XG5cblxubGV0IHNwcml0ZXMgPSB7IH07XG5cbmxldCBmcmFtZTtcblxub25Nb3VudChhc3luYyAoKT0+e1xuICBjb25zdCB7IFBhdHRlcm5zIH0gPSAoYXdhaXQgaW1wb3J0KFwiLi4vLi4vY29tcG9uZW50cy9DYW52YXNQYXR0ZXJucy5qc1wiKSk7XG4gIHNwcml0ZXMuY2l0eSA9IG5ldyBJbWFnZSgpO1xuICBzcHJpdGVzLmNpdHkuc3JjID0gXCIvY2l0eV9vbi5wbmdcIjtcbiAgc3ByaXRlcy5jYXN0bGUgPSBuZXcgSW1hZ2UoKTtcbiAgc3ByaXRlcy5jYXN0bGUuc3JjID0gXCIvY2FzdGxlX29uLnBuZ1wiO1xuICBzcHJpdGVzLnRvd24gPSBuZXcgSW1hZ2UoKTtcbiAgc3ByaXRlcy50b3duLnNyYyA9IFwiL3Rvd25fb24ucG5nXCI7XG4gIHNwcml0ZXMuY2l0eV9uaWdodCA9IG5ldyBJbWFnZSgpO1xuICBzcHJpdGVzLmNpdHlfbmlnaHQuc3JjID0gXCIvY2l0eV9vZmYucG5nXCI7XG4gIHNwcml0ZXMuY2FzdGxlX25pZ2h0ID0gbmV3IEltYWdlKCk7XG4gIHNwcml0ZXMuY2FzdGxlX25pZ2h0LnNyYyA9IFwiL2Nhc3RsZV9vZmYucG5nXCI7XG4gIHNwcml0ZXMudG93bl9uaWdodCA9IG5ldyBJbWFnZSgpO1xuICBzcHJpdGVzLnRvd25fbmlnaHQuc3JjID0gXCIvdG93bl9vZmYucG5nXCI7XG4gIHNwcml0ZXMuZmlyZSA9IG5ldyBJbWFnZSgpO1xuICBzcHJpdGVzLmZpcmUuc3JjID0gXCIvZmlyZS5wbmdcIjtcbiAgbGV0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gIGNhbnZhcy53aWR0aCA9IGNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDtcbiAgY2FudmFzLmhlaWdodCA9IGNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7XG4gIC8vY2FudmFzLmhlaWdodCA9IGNhbnZhcy53aWR0aDsvL2NhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7XG4gIHBpZWNlX3NpemUgPSBbTWF0aC5taW4oY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KSAvIG4sIE1hdGgubWluKGNhbnZhcy5oZWlnaHQsIGNhbnZhcy53aWR0aCkgLyBuXTtcbiAgbGV0IGJvcmRlcl93aWR0aCA9IDY7XG4gIGxldCByZXByZXNlbnRvcl9vZl9jbHVzdGVyID0gW107XG4gIGxldCBjbHVzdGVyX3RvX3N0cmVhbWVycyA9IFtdO1xuICBsZXQgc3RyZWFtZXJfbWF0cml4ID0gQXJyYXkobikuZmlsbCgpLm1hcCgoKT0+QXJyYXkobikuZmlsbChudWxsKSk7XG4gIGZvcihsZXQgcyBvZiBzdHJlYW1lcnMpIHtcbiAgICBzLmltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgc3RyZWFtZXJfbWF0cml4W3MueF1bcy55XSA9IHM7XG4gICAgaWYocy5jbHVzdGVyID49IDApIHtcbiAgICAgIGlmKGNsdXN0ZXJfdG9fc3RyZWFtZXJzW3MuY2x1c3Rlcl0gPT0gbnVsbCkgXG4gICAgICAgIGNsdXN0ZXJfdG9fc3RyZWFtZXJzW3MuY2x1c3Rlcl0gPSBbXTtcbiAgICAgIGNsdXN0ZXJfdG9fc3RyZWFtZXJzW3MuY2x1c3Rlcl0ucHVzaChzKTtcbiAgICB9XG4gIH1cbiAgZm9yKGxldCBpIGluIGNsdXN0ZXJfdG9fc3RyZWFtZXJzKSB7XG4gICAgY2x1c3Rlcl90b19zdHJlYW1lcnNbaV0uc29ydCgoYSwgYikgPT4gYi5wcm9iYWJpbGl0eSAtIGEucHJvYmFiaWxpdHkpO1xuICAgIHJlcHJlc2VudG9yX29mX2NsdXN0ZXJbaV0gPSBjbHVzdGVyX3RvX3N0cmVhbWVyc1tpXVswXTtcbiAgICByZXByZXNlbnRvcl9vZl9jbHVzdGVyW2ldLnJlcHJlc2VudGF0aW9uX3ggPSBjbHVzdGVyX3RvX3N0cmVhbWVyc1tpXS5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLngsIDApIC8gY2x1c3Rlcl90b19zdHJlYW1lcnNbaV0ubGVuZ3RoO1xuICAgIHJlcHJlc2VudG9yX29mX2NsdXN0ZXJbaV0ucmVwcmVzZW50YXRpb25feSA9IGNsdXN0ZXJfdG9fc3RyZWFtZXJzW2ldLnJlZHVjZSgoYSwgYikgPT4gYSArIGIueSwgMCkgLyBjbHVzdGVyX3RvX3N0cmVhbWVyc1tpXS5sZW5ndGg7XG4gIH1cbiAgZm9yKGxldCBzIG9mIHN0cmVhbWVycykge1xuICAgIGlmKHMuY2x1c3RlciA+PSAwICYmIChzLngtMSA8IDAgfHwgc3RyZWFtZXJfbWF0cml4W3MueC0xXVtzLnldID09IG51bGwgfHwgc3RyZWFtZXJfbWF0cml4W3MueC0xXVtzLnldLmNsdXN0ZXIgIT0gcy5jbHVzdGVyKSlcbiAgICAgIHMubGVmdF9lZGdlID0gdHJ1ZTtcbiAgICBpZihzLmNsdXN0ZXIgPj0gMCAmJiAocy54KzEgPj0gc3RyZWFtZXJfbWF0cml4Lmxlbmd0aCB8fCBzdHJlYW1lcl9tYXRyaXhbcy54KzFdW3MueV0gPT0gbnVsbCB8fCBzdHJlYW1lcl9tYXRyaXhbcy54KzFdW3MueV0uY2x1c3RlciAhPSBzLmNsdXN0ZXIpKVxuICAgICAgcy5yaWdodF9lZGdlID0gdHJ1ZTtcbiAgICBpZihzLmNsdXN0ZXIgPj0gMCAmJiAocy55LTEgPCAwIHx8IHN0cmVhbWVyX21hdHJpeFtzLnhdW3MueS0xXSA9PSBudWxsIHx8IHN0cmVhbWVyX21hdHJpeFtzLnhdW3MueS0xXS5jbHVzdGVyICE9IHMuY2x1c3RlcikpXG4gICAgICBzLnRvcF9lZGdlID0gdHJ1ZTtcbiAgICBpZihzLmNsdXN0ZXIgPj0gMCAmJiAocy55KzEgPj0gc3RyZWFtZXJfbWF0cml4Lmxlbmd0aCB8fCBzdHJlYW1lcl9tYXRyaXhbcy54XVtzLnkrMV0gPT0gbnVsbCB8fCBzdHJlYW1lcl9tYXRyaXhbcy54XVtzLnkrMV0uY2x1c3RlciAhPSBzLmNsdXN0ZXIpKVxuICAgICAgcy5ib3R0b21fZWRnZSA9IHRydWU7XG4gIH1cbiAgbGV0IGZyYW1lX2luZGV4ID0gMDtcbiAgY3R4LnRleHRCYXNlbGluZSA9IFwidG9wXCI7XG4gIGN0eC50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuICBjdHguZm9udCA9IFwiMTJweCBBcmlhbFwiO1xuXG4gIGxldCBwdywgcGg7XG4gIGxldCB2aWV3O1xuXG4gIGNhbnZhcy5vbmRibGNsaWNrID0gZnVuY3Rpb24oZSl7XG4gICAgbGV0IHRhcmdldCA9IChzdHJlYW1lcl9tYXRyaXhbTWF0aC5mbG9vcigoZS5wYWdlWCAtIGNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS54ICsgdmlld1swXSkgLyBwdyldIHx8IFtdKVtNYXRoLmZsb29yKChlLnBhZ2VZIC0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnkgKyB2aWV3WzFdKSAvIHBoKV07XG4gICAgaWYodGFyZ2V0KVxuICAgICAgbG9jYXRpb24gPSBgL3N0cmVhbWVyLyR7dGFyZ2V0LmlkfWA7XG4gICAgcmV0dXJuIGUucHJldmVudERlZmF1bHQoKSAmJiBmYWxzZTtcbiAgfVxuICBsZXQgdGltZXIgPSBudWxsLCBsYXN0X3RhcmdldDtcbiAgbGV0IGNhbnZhc190b3VjaF9lbmQgPSBmdW5jdGlvbihlKSB7XG4gICAgaWYgKGUudG91Y2hlcy5sZW5ndGggPj0gMSkgcmV0dXJuO1xuICAgIGZpbmdlcl9kaXN0ID0gMDtcbiAgICBsZXQgdGFyZ2V0ID0gKHN0cmVhbWVyX21hdHJpeFtNYXRoLmZsb29yKChsYXN0X3BvaW50ZXJfeCArIHZpZXdbMF0pIC8gcHcpXSB8fCBbXSlbTWF0aC5mbG9vcigobGFzdF9wb2ludGVyX3kgKyB2aWV3WzFdKSAvIHBoKV07XG4gICAgaWYodGltZXIgPT0gbnVsbCl7XG4gICAgICBsYXN0X3RhcmdldCA9IHRhcmdldDtcbiAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGltZXIgPSBudWxsO1xuICAgICAgICAgIGxhc3RfdGFyZ2V0ID0gbnVsbDtcbiAgICAgIH0sIDMwMCk7XG4gICAgfWVsc2Uge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgIHRpbWVyID0gbnVsbDtcbiAgICAgIGlmKHRhcmdldCAmJiB0YXJnZXQgPT0gbGFzdF90YXJnZXQpXG4gICAgICAgIGxvY2F0aW9uID0gYC9zdHJlYW1lci8ke3RhcmdldC5pZH1gO1xuICAgICAgZWxzZSB7XG4gICAgICAgIGxhc3RfdGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGltZXIgPSBudWxsO1xuICAgICAgICAgICAgbGFzdF90YXJnZXQgPSBudWxsO1xuICAgICAgICB9LCAzMDApO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgbGV0IHNlYXJjaGVkID0gW107XG4gIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgY2FudmFzX3RvdWNoX2VuZCk7XG4gIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hjYW5jZWxcIiwgY2FudmFzX3RvdWNoX2VuZCk7XG4gIChmdW5jdGlvbiBsb29wKCkge1xuICAgIGZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApO1xuICAgIGlmKHNlYXJjaCkge1xuICAgICAgY2FtZXJhWzBdID0gc2VhcmNoLngvbjtcbiAgICAgIGNhbWVyYVsxXSA9IHNlYXJjaC55L247XG4gICAgICBzZWFyY2guaGlnaGxpZ2h0ID0gdHJ1ZTtcbiAgICAgIHNlYXJjaGVkLnB1c2goc2VhcmNoKTtcbiAgICAgIHNlYXJjaCA9IG51bGw7XG4gICAgfVxuICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgICBwdyA9IE1hdGguY2VpbChwaWVjZV9zaXplWzBdKmNhbWVyYVsyXSk7XG4gICAgcGggPSBNYXRoLmNlaWwocGllY2Vfc2l6ZVsxXSpjYW1lcmFbMl0pO1xuICAgIHZpZXcgPSBbcHcqbipjYW1lcmFbMF0gLSBjYW52YXMud2lkdGgqMC41LCBwaCpuKmNhbWVyYVsxXSAtIGNhbnZhcy5oZWlnaHQqMC41LCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHRdO1xuICAgIGxldCB2aWV3X3ggPSBNYXRoLmZsb29yKHZpZXdbMF0vcHcpLCBcbiAgICAgICAgdmlld195ID0gTWF0aC5mbG9vcih2aWV3WzFdL3BoKSxcbiAgICAgICAgdmlld194MiA9IE1hdGguY2VpbCgodmlld1swXSt2aWV3WzJdKSAvIHB3KSxcbiAgICAgICAgdmlld195MiA9IE1hdGguY2VpbCgodmlld1sxXSt2aWV3WzNdKSAvIHBoKTtcbiAgICBib3JkZXJfd2lkdGggPSBwdy8xMDtcbiAgICBjdHguZm9udCA9IE1hdGgubWF4KE1hdGguZmxvb3IocHcvNSksIDEyKSArIFwicHggQXJpYWxcIjtcbiAgICBsZXQgaG92ZXJlZCA9IChzdHJlYW1lcl9tYXRyaXhbTWF0aC5mbG9vcigobGFzdF9wb2ludGVyX3ggKyB2aWV3WzBdKSAvIHB3KV0gfHwgW10pW01hdGguZmxvb3IoKGxhc3RfcG9pbnRlcl95ICsgdmlld1sxXSkgLyBwaCldO1xuICAgIC8vIFpvb21lZCBlbm91Z2g6IHByZXNlbnQgYWxsIHN0cmVhbWVyc1xuICAgIGN0eC5zYXZlKCk7XG4gICAgLy9jdHguZmlsbFN0eWxlID0gQ09MT1JTLnNlYTtcbiAgICAvL2N0eC5maWxsUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuICAgIGN0eC5yZXN0b3JlKCk7XG4gIFxuICAgIGZvcihsZXQgeD12aWV3X3g7IHg8PXZpZXdfeDI7ICsreCl7XG4gICAgICBmb3IobGV0IHk9dmlld195OyB5PD12aWV3X3kyOyArK3kpe1xuICAgICAgICBsZXQgcHggPSBNYXRoLmZsb29yKHB3KnggLSB2aWV3WzBdKSwgXG4gICAgICAgICAgICBweSA9IE1hdGguZmxvb3IocGgqeSAtIHZpZXdbMV0pO1xuICAgICAgICBpZihzdHJlYW1lcl9tYXRyaXhbeF0gPT0gbnVsbCB8fCBzdHJlYW1lcl9tYXRyaXhbeF1beV0gPT0gbnVsbCkge1xuICAgICAgICAgIGN0eC5zYXZlKClcbiAgICAgICAgICAvL2N0eC5maWxsU3R5bGUgPSBcIiM3MTgwOTZcIlxuICAgICAgICAgIC8vY3R4LmZpbGxTdHlsZSA9IFwiIzQxNGE0Y1wiXG4gICAgICAgICAgLy9jdHguZmlsbFN0eWxlID0gQ09MT1JTLnNlYTtcbiAgICAgICAgICAvL2N0eC5maWxsUmVjdChweCwgcHksIHB3LCBwaCk7XG4gICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcyA9IHN0cmVhbWVyX21hdHJpeFt4XVt5XTtcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IENPTE9SUy5sYW5kO1xuICAgICAgICBjdHguZmlsbFJlY3QocHgsIHB5LCBwdywgcGgpO1xuICAgICAgICBpZihzLmNsdXN0ZXIgPj0gMCkge1xuICAgICAgICAgIGN0eC5zYXZlKClcbiAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAwLjU7XG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFBhdHRlcm5zW3MuY2x1c3Rlcl07XG4gICAgICAgICAgY3R4LmZpbGxSZWN0KHB4LCBweSwgcHcsIHBoKTtcbiAgICAgICAgICBjdHgucmVzdG9yZSgpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYocHcgPj0gNjQgJiYgcGggPj0gNjQpIHtcbiAgICAgIGZvcihsZXQgeD12aWV3X3g7IHg8PXZpZXdfeDI7ICsreCl7XG4gICAgICAgIGZvcihsZXQgeT12aWV3X3k7IHk8PXZpZXdfeTI7ICsreSl7XG4gICAgICAgICAgbGV0IHB4ID0gTWF0aC5mbG9vcihwdyp4IC0gdmlld1swXSksIFxuICAgICAgICAgICAgICBweSA9IE1hdGguZmxvb3IocGgqeSAtIHZpZXdbMV0pO1xuICAgICAgICAgIGlmKHN0cmVhbWVyX21hdHJpeFt4XSA9PSBudWxsIHx8IHN0cmVhbWVyX21hdHJpeFt4XVt5XSA9PSBudWxsKXtcbiAgICAgICAgICAgIGN0eC5zYXZlKClcbiAgICAgICAgICAgIC8vY3R4LmZpbGxTdHlsZSA9IFwiIzcxODA5NlwiXG4gICAgICAgICAgICAvL2N0eC5maWxsU3R5bGUgPSBDT0xPUlMuc2VhO1xuICAgICAgICAgICAgLy8gIGN0eC5maWxsUmVjdChweCwgcHksIHB3LCBwaCk7XG4gICAgICAgICAgICBjdHgucmVzdG9yZSgpXG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsZXQgcyA9IHN0cmVhbWVyX21hdHJpeFt4XVt5XTtcbiAgICAgICAgICBpZihwb3RyYWl0X3Nob3cpe1xuICAgICAgICAgICAgY3R4LnNhdmUoKTtcbiAgICAgICAgICAgIGlmKHMuaW1hZ2Uuc3JjICYmIHMuaW1hZ2UuY29tcGxldGUgJiYgcy5pbWFnZS5uYXR1cmFsV2lkdGggPiAwKVxuICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKHMuaW1hZ2UsIHB4LCBweSwgcHcsIHBoKTtcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICBpZighcy5pbWFnZS5zcmMpIFxuICAgICAgICAgICAgICAgIHMuaW1hZ2Uuc3JjID0gcy5wcm9maWxlX2ltYWdlX3VybDtcbiAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiI0NEQThDN1wiO1xuICAgICAgICAgICAgICBjdHguZmlsbFRleHQoXCLroZzrlKnspJFcIiwgcHggKyBwdyowLjUsIHB5KTsgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdHgucmVzdG9yZSgpXG4gICAgICAgICAgfVxuICAgICAgICAgIGlmKHMuaGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICBpZihzID09IGhvdmVyZWQpXG4gICAgICAgICAgICAgIHMuaGlnaGxpZ2h0ID0gZmFsc2U7XG4gICAgICAgICAgICBpZihmcmFtZV9pbmRleCUxMCA+IDUpe1xuICAgICAgICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAwLjU7XG4gICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBDT0xPUlMuaGlnaGxpZ2h0O1xuICAgICAgICAgICAgICBjdHguZmlsbFJlY3QocHggKyBib3JkZXJfd2lkdGgsIHB5K2JvcmRlcl93aWR0aCwgcHcgLSAyKmJvcmRlcl93aWR0aCwgcGggLSAyKmJvcmRlcl93aWR0aCk7XG4gICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDEuMDtcbiAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZihuYW1lX3Nob3cgfHwgaG92ZXJlZCA9PSBzKXtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICBsZXQgZmggPSBwYXJzZUludChjdHguZm9udCksXG4gICAgICAgICAgICAgICAgZncgPSBjdHgubWVhc3VyZVRleHQocy5uYW1lKS53aWR0aCxcbiAgICAgICAgICAgICAgICBsID0gTWF0aC5jZWlsKGZ3LyhwdyAtIDIqYm9yZGVyX3dpZHRoKSksXG4gICAgICAgICAgICAgICAgdGV4dF9waWVjZV9sZW5ndGggPSBNYXRoLmZsb29yKHMubmFtZS5sZW5ndGggLyBsKTtcbiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNztcbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIiNmZmZcIjtcbiAgICAgICAgICAgIGN0eC5maWxsUmVjdChweCArIGJvcmRlcl93aWR0aCwgcHkrcGggLSBib3JkZXJfd2lkdGggLSBmaCpsLCBwdyAtIDIqYm9yZGVyX3dpZHRoLCBmaCpsKTtcbiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDEuMDtcbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIiMwMDBcIjtcbiAgICAgICAgICAgIGZvcihsZXQgaT0wOyBpPGwtMTsgKytpKVxuICAgICAgICAgICAgICBjdHguZmlsbFRleHQocy5uYW1lLnN1YnN0cihpKnRleHRfcGllY2VfbGVuZ3RoLCB0ZXh0X3BpZWNlX2xlbmd0aCksIHB4ICsgcHcqMC41LCBweSArIHBoIC0gYm9yZGVyX3dpZHRoIC0gZmgqbCArIGkqZmgpO1xuICAgICAgICAgICAgY3R4LmZpbGxUZXh0KHMubmFtZS5zbGljZSgobC0xKSp0ZXh0X3BpZWNlX2xlbmd0aCksIHB4K3B3KjAuNSwgcHkgKyBwaCAtIGJvcmRlcl93aWR0aCAtIGZoKTtcbiAgICAgICAgICAgIC8vY3R4LmZpbGxUZXh0KHMubmFtZSwgcHggKyBwdyowLjUsIHB5ICsgcGggLSBib3JkZXJfd2lkdGggLSBmaCk7XG4gICAgICAgICAgICBjdHgucmVzdG9yZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZihzLmlzX3N0cmVhbWluZyl7XG4gICAgICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gTWF0aC5hYnMoTWF0aC5zaW4oZnJhbWVfaW5kZXgvMjApKTtcbiAgICAgICAgICAgIGN0eC5hcmMocHggKyBib3JkZXJfd2lkdGggKyBwdy8xNSwgcHkgKyBib3JkZXJfd2lkdGggKyBwaC8xNSwgcHcvMTUtMSwgMCwgMiAqIE1hdGguUEksIGZhbHNlKTtcbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIiNGRjQ1NjBcIjtcbiAgICAgICAgICAgIGN0eC5maWxsKCk7XG4gICAgICAgICAgICBjdHgucmVzdG9yZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBlbHNle1xuICAgICAgaWYocHcgPiAzMiAmJiBwaCA+IDMyKXtcbiAgICAgICAgZm9yKGxldCBzIG9mIHJlcHJlc2VudG9yX29mX2NsdXN0ZXIpIHtcbiAgICAgICAgICAgIGxldCByeCA9IHB3KnMucmVwcmVzZW50YXRpb25feCAtIHZpZXdbMF0gKyBwdyowLjUgKyAoY2FtZXJhWzBdIC0gMC41KSpwdyxcbiAgICAgICAgICAgICAgICByeSA9IHBoKnMucmVwcmVzZW50YXRpb25feSAtIHZpZXdbMV0gKyBwaCowLjUgKyAoY2FtZXJhWzFdIC0gMC41KSpwaDtcbiAgICAgICAgICAgIGxldCBweCA9IHB3KnMueCAtIHZpZXdbMF0sIFxuICAgICAgICAgICAgICAgIHB5ID0gcGgqcy55IC0gdmlld1sxXTtcbiAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxLjA7XG4gICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gXCJtaWRkbGVcIjtcbiAgICAgICAgICAgIGN0eC50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcbiAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IFwiYmxhY2tcIjtcbiAgICAgICAgICAgIGN0eC5mb250ID0gXCJpdGFsaWMgXCIgKyBNYXRoLm1heChNYXRoLmZsb29yKHB3LzEuNSksIDEyKSArIFwicHggQXJpYWxcIjtcbiAgICAgICAgICAgIGxldCBmdyA9IGN0eC5tZWFzdXJlVGV4dChzLm5hbWUpLndpZHRoLFxuICAgICAgICAgICAgICAgIGZoID0gcGFyc2VJbnQoY3R4LmZvbnQpO1xuICAgICAgICAgICAgY3R4LmZpbGxUZXh0KHMubmFtZSwgcngsIHJ5KTtcbiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yKGxldCB4PXZpZXdfeDsgeDw9dmlld194MjsgKyt4KXtcbiAgICAgICAgICBmb3IobGV0IHk9dmlld195OyB5PD12aWV3X3kyOyArK3kpe1xuICAgICAgICAgICAgbGV0IHB4ID0gTWF0aC5mbG9vcihwdyp4IC0gdmlld1swXSksIFxuICAgICAgICAgICAgICAgIHB5ID0gTWF0aC5mbG9vcihwaCp5IC0gdmlld1sxXSk7XG4gICAgICAgICAgICBpZihzdHJlYW1lcl9tYXRyaXhbeF0gPT0gbnVsbCB8fCBzdHJlYW1lcl9tYXRyaXhbeF1beV0gPT0gbnVsbClcbiAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICBsZXQgcyA9IHN0cmVhbWVyX21hdHJpeFt4XVt5XTtcbiAgICAgICAgICAgIGlmKCEocyA9PSBob3ZlcmVkIHx8IHMuaGlnaGxpZ2h0KSkge1xuICAgICAgICAgICAgICBpZihzLmF2ZXJhZ2Vfdmlld2VyX2NvdW50ID49IDEwMDAwKSB7XG4gICAgICAgICAgICAgICAgaWYocy5pc19zdHJlYW1pbmcpe1xuICAgICAgICAgICAgICAgICAgaWYoc3ByaXRlcy5jaXR5LmNvbXBsZXRlKVxuICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKHNwcml0ZXMuY2l0eSwgcHgsIHB5LCBwdywgcGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGlmKHNwcml0ZXMuY2l0eV9uaWdodC5jb21wbGV0ZSlcbiAgICAgICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShzcHJpdGVzLmNpdHlfbmlnaHQsIHB4LCBweSwgcHcsIHBoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxzZSBpZihzLmF2ZXJhZ2Vfdmlld2VyX2NvdW50ID49IDEwMDApIHtcbiAgICAgICAgICAgICAgICBpZihzLmlzX3N0cmVhbWluZyl7XG4gICAgICAgICAgICAgICAgICBpZihzcHJpdGVzLmNhc3RsZS5jb21wbGV0ZSlcbiAgICAgICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShzcHJpdGVzLmNhc3RsZSwgcHgrcHcqMC4yLCBweStwaCowLjIsIHB3KjAuNiwgcGgqMC42KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICBpZihzcHJpdGVzLmNhc3RsZV9uaWdodC5jb21wbGV0ZSlcbiAgICAgICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShzcHJpdGVzLmNhc3RsZV9uaWdodCwgcHgrcHcqMC4yLCBweStwaCowLjIsIHB3KjAuNiwgcGgqMC42KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZWxzZSBpZihzLmF2ZXJhZ2Vfdmlld2VyX2NvdW50ID49IDEwMCkge1xuICAgICAgICAgICAgICAgIGlmKHMuaXNfc3RyZWFtaW5nKXtcbiAgICAgICAgICAgICAgICAgIGlmKHNwcml0ZXMudG93bi5jb21wbGV0ZSlcbiAgICAgICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShzcHJpdGVzLnRvd24sIHB4K3B3KjAuMiwgcHkrcGgqMC4yLCBwdyowLjYsIHBoKjAuNik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgaWYoc3ByaXRlcy50b3duX25pZ2h0LmNvbXBsZXRlKVxuICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKHNwcml0ZXMudG93bl9uaWdodCwgcHgrcHcqMC4yLCBweStwaCowLjIsIHB3KjAuNiwgcGgqMC42KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLyplbHNlIHtcbiAgICAgICAgICAgICAgICBpZihzLmlzX3N0cmVhbWluZykge1xuICAgICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiI2ZmZmUwMFwiO1xuICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgICAgY3R4LmFyYyhweCArIHB3KjAuNSwgcHkgKyBwaCowLjUsIHB3KjAuMDUsIDAsIE1hdGguUEkqMik7XG4gICAgICAgICAgICAgICAgICBjdHguZmlsbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSovXG4gICAgICAgICAgICAgIGlmKHMuaXNfc3RyZWFtaW5nICYmIHMuY2hhdHRpbmdfc3BlZWQgPj0gNSl7XG4gICAgICAgICAgICAgICAgaWYoc3ByaXRlcy5maXJlLmNvbXBsZXRlKXtcbiAgICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNTtcbiAgICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2Uoc3ByaXRlcy5maXJlLCBweCArIHB3KjAuMiwgcHkrcGgqMC4yLCBwdyowLjYsIHBoKjAuNik7XG4gICAgICAgICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxLjA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGlmKCFzLmlzX3N0cmVhbWluZyl7XG4gICAgICAgICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC4zO1xuICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIiMwMDBcIjtcbiAgICAgICAgICAgICAgICBjdHguZmlsbFJlY3QocHgsIHB5LCBwdywgcGgpO1xuICAgICAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDEuMDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYoaG92ZXJlZCkge1xuICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICBsZXQgcyA9IGhvdmVyZWQ7XG4gICAgICAgIGxldCBweCA9IHB3KnMueCAtIHZpZXdbMF0sIFxuICAgICAgICAgIHB5ID0gcGgqcy55IC0gdmlld1sxXTtcbiAgICAgICAgaWYocy5pbWFnZS5zcmMgJiYgcy5pbWFnZS5jb21wbGV0ZSAmJiBzLmltYWdlLm5hdHVyYWxXaWR0aCA+IDApXG4gICAgICAgICAgY3R4LmRyYXdJbWFnZShzLmltYWdlLCBweCwgcHksIHB3LCBwaCk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIGlmKCFzLmltYWdlLnNyYykgXG4gICAgICAgICAgICBzLmltYWdlLnNyYyA9IHMucHJvZmlsZV9pbWFnZV91cmw7XG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiI0NEQThDN1wiO1xuICAgICAgICAgIGN0eC5maWxsVGV4dChcIuuhnOuUqeykkVwiLCBweCArIHB3KjAuNSwgcHkpOyBcbiAgICAgICAgfVxuICAgICAgICBjdHgucmVzdG9yZSgpO1xuICAgICAgfVxuICAgICAgZm9yKGxldCBpPTAsIGw9c2VhcmNoZWQubGVuZ3RoOyBpPGw7ICsraSkge1xuICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICBsZXQgcyA9IHNlYXJjaGVkW2ldO1xuICAgICAgICBsZXQgcHggPSBwdypzLnggLSB2aWV3WzBdLCBcbiAgICAgICAgICBweSA9IHBoKnMueSAtIHZpZXdbMV07XG4gICAgICAgIGlmKHMuaW1hZ2Uuc3JjICYmIHMuaW1hZ2UuY29tcGxldGUgJiYgcy5pbWFnZS5uYXR1cmFsV2lkdGggPiAwKVxuICAgICAgICAgIGN0eC5kcmF3SW1hZ2Uocy5pbWFnZSwgcHgsIHB5LCBwdywgcGgpO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBpZighcy5pbWFnZS5zcmMpIFxuICAgICAgICAgICAgcy5pbWFnZS5zcmMgPSBzLnByb2ZpbGVfaW1hZ2VfdXJsO1xuICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIiNDREE4QzdcIjtcbiAgICAgICAgICBjdHguZmlsbFRleHQoXCLroZzrlKnspJFcIiwgcHggKyBwdyowLjUsIHB5KTsgXG4gICAgICAgIH1cbiAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgaWYocyA9PSBob3ZlcmVkKXtcbiAgICAgICAgICBzZWFyY2hlZC5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgaSAtPSAxO1xuICAgICAgICAgIGwgLT0gMTtcbiAgICAgICAgICBzLmhpZ2hsaWdodCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmKGZyYW1lX2luZGV4JTEwID4gNSl7XG4gICAgICAgICAgY3R4LnNhdmUoKTtcbiAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAwLjU7XG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiI2Q0YWYzN1wiO1xuICAgICAgICAgIGN0eC5maWxsUmVjdChweCArIGJvcmRlcl93aWR0aCwgcHkrYm9yZGVyX3dpZHRoLCBwdyAtIDIqYm9yZGVyX3dpZHRoLCBwaCAtIDIqYm9yZGVyX3dpZHRoKTtcbiAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxLjA7XG4gICAgICAgICAgY3R4LnJlc3RvcmUoKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGZvcihsZXQgeD12aWV3X3g7IHg8PXZpZXdfeDI7ICsreCl7XG4gICAgICBmb3IobGV0IHk9dmlld195OyB5PD12aWV3X3kyOyArK3kpe1xuICAgICAgICBsZXQgcHggPSBNYXRoLmZsb29yKHB3KnggLSB2aWV3WzBdKSwgXG4gICAgICAgICAgICBweSA9IE1hdGguZmxvb3IocGgqeSAtIHZpZXdbMV0pO1xuICAgICAgICBpZihzdHJlYW1lcl9tYXRyaXhbeF0gPT0gbnVsbCB8fCBzdHJlYW1lcl9tYXRyaXhbeF1beV0gPT0gbnVsbClcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgbGV0IHMgPSBzdHJlYW1lcl9tYXRyaXhbeF1beV07XG4gICAgICAgIC8qXG4gICAgICAgIGlmKCFzLmlzX3N0cmVhbWluZyl7XG4gICAgICAgICAgY3R4LnNhdmUoKTtcbiAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAwLjI7XG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiIzAwMFwiO1xuICAgICAgICAgIGN0eC5maWxsUmVjdChweCwgcHksIHB3LCBwaCk7XG4gICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgfSBlbHNle1xuICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC4yO1xuICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIiNmZmZcIjtcbiAgICAgICAgICBjdHguZmlsbFJlY3QocHgsIHB5LCBwdywgcGgpO1xuICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgIH0qL1xuICAgICAgICBpZihjbHVzdGVyaW5nX3Nob3cpIHtcbiAgICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICAgIGlmKGhvdmVyZWQgJiYgaG92ZXJlZC5jbHVzdGVyID09IHMuY2x1c3RlcikgXG4gICAgICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSBNYXRoLmFicyhNYXRoLnNpbihmcmFtZV9pbmRleC8yMCkpO1xuICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBQYXR0ZXJuc1tzLmNsdXN0ZXJdO1xuICAgICAgICAgIGlmKHMubGVmdF9lZGdlKXtcbiAgICAgICAgICAgIGxldCB5PXB5LCB5Mj1weStwaDtcbiAgICAgICAgICAgIGlmKCFzLmJvdHRvbV9lZGdlKVxuICAgICAgICAgICAgICB5MiArPSBib3JkZXJfd2lkdGg7XG4gICAgICAgICAgICBpZighcy50b3BfZWRnZSlcbiAgICAgICAgICAgICAgeSAtPSBib3JkZXJfd2lkdGg7XG4gICAgICAgICAgICBjdHguZmlsbFJlY3QoXG4gICAgICAgICAgICAgICAgcHgsXG4gICAgICAgICAgICAgICAgeSxcbiAgICAgICAgICAgICAgICBib3JkZXJfd2lkdGgsIHkyLXkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZihzLnJpZ2h0X2VkZ2Upe1xuICAgICAgICAgICAgbGV0IHk9cHksIHkyPXB5K3BoO1xuICAgICAgICAgICAgaWYoIXMuYm90dG9tX2VkZ2UpXG4gICAgICAgICAgICAgIHkyICs9IGJvcmRlcl93aWR0aDtcbiAgICAgICAgICAgIGlmKCFzLnRvcF9lZGdlKVxuICAgICAgICAgICAgICB5IC09IGJvcmRlcl93aWR0aDtcbiAgICAgICAgICAgIGN0eC5maWxsUmVjdChcbiAgICAgICAgICAgICAgICBweCArIHB3IC0gYm9yZGVyX3dpZHRoLFxuICAgICAgICAgICAgICAgIHksIFxuICAgICAgICAgICAgICAgIGJvcmRlcl93aWR0aCwgeTIteSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmKHMudG9wX2VkZ2Upe1xuICAgICAgICAgICAgbGV0IHg9cHgsIHgyPXB4ICsgcHc7XG4gICAgICAgICAgICBpZighcy5yaWdodF9lZGdlKVxuICAgICAgICAgICAgICB4MiArPSBib3JkZXJfd2lkdGg7XG4gICAgICAgICAgICBpZighcy5sZWZ0X2VkZ2UpXG4gICAgICAgICAgICAgIHggLT0gYm9yZGVyX3dpZHRoO1xuICAgICAgICAgICAgY3R4LmZpbGxSZWN0KFxuICAgICAgICAgICAgICAgIHgsIFxuICAgICAgICAgICAgICAgIHB5LFxuICAgICAgICAgICAgICAgIHgyLXgsIGJvcmRlcl93aWR0aCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmKHMuYm90dG9tX2VkZ2Upe1xuICAgICAgICAgICAgbGV0IHg9cHgsIHgyPXB4K3B3O1xuICAgICAgICAgICAgaWYoIXMucmlnaHRfZWRnZSlcbiAgICAgICAgICAgICAgeDIgKz0gYm9yZGVyX3dpZHRoO1xuICAgICAgICAgICAgaWYoIXMubGVmdF9lZGdlKVxuICAgICAgICAgICAgICB4IC09IGJvcmRlcl93aWR0aDtcbiAgICAgICAgICAgIGN0eC5maWxsUmVjdChcbiAgICAgICAgICAgICAgICB4LCBcbiAgICAgICAgICAgICAgICBweSArIHBoIC0gYm9yZGVyX3dpZHRoLFxuICAgICAgICAgICAgICAgIHgyLXgsIGJvcmRlcl93aWR0aCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYocHcgPCA2NCB8fCBwaCA8IDY0KSB7XG4gICAgICBmb3IobGV0IHg9dmlld194OyB4PD12aWV3X3gyOyArK3gpe1xuICAgICAgICBmb3IobGV0IHk9dmlld195OyB5PD12aWV3X3kyOyArK3kpe1xuICAgICAgICAgIGxldCBweCA9IE1hdGguZmxvb3IocHcqeCAtIHZpZXdbMF0pLCBcbiAgICAgICAgICAgICAgcHkgPSBNYXRoLmZsb29yKHBoKnkgLSB2aWV3WzFdKTtcbiAgICAgICAgICBpZihzdHJlYW1lcl9tYXRyaXhbeF0gPT0gbnVsbCB8fCBzdHJlYW1lcl9tYXRyaXhbeF1beV0gPT0gbnVsbClcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIGxldCBzID0gc3RyZWFtZXJfbWF0cml4W3hdW3ldO1xuICAgICAgICAgIGlmKGhvdmVyZWQgPT0gcykge1xuICAgICAgICAgICAgY3R4LnNhdmUoKTtcbiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNztcbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIiNmZmZcIjtcbiAgICAgICAgICAgIGxldCBmaCA9IHBhcnNlSW50KGN0eC5mb250KSxcbiAgICAgICAgICAgICAgICBmdyA9IGN0eC5tZWFzdXJlVGV4dChzLm5hbWUpLndpZHRoO1xuICAgICAgICAgICAgY3R4LmZpbGxSZWN0KHB4ICsgcHcqMC41IC0gZncqMC41LCBweStwaCwgZncsIGZoKTtcbiAgICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDEuMDtcbiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIiMwMDBcIjtcbiAgICAgICAgICAgIGN0eC5maWxsVGV4dChzLm5hbWUsIHB4K3B3KjAuNSwgcHkrcGgpO1xuICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZvcihsZXQgcyBvZiByZXByZXNlbnRvcl9vZl9jbHVzdGVyKSB7XG4gICAgICAgICAgbGV0IHJ4ID0gcHcqcy5yZXByZXNlbnRhdGlvbl94IC0gdmlld1swXSArIHB3KjAuNSArIChjYW1lcmFbMF0gLSAwLjUpKnB3LFxuICAgICAgICAgICAgICByeSA9IHBoKnMucmVwcmVzZW50YXRpb25feSAtIHZpZXdbMV0gKyBwaCowLjUgKyAoY2FtZXJhWzFdIC0gMC41KSpwaDtcbiAgICAgICAgICBsZXQgcHggPSBwdypzLnggLSB2aWV3WzBdLCBcbiAgICAgICAgICAgICAgcHkgPSBwaCpzLnkgLSB2aWV3WzFdO1xuICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC43O1xuICAgICAgICAgIGN0eC50ZXh0QmFzZWxpbmUgPSBcIm1pZGRsZVwiO1xuICAgICAgICAgIGN0eC50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XG4gICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gXCJibGFja1wiO1xuICAgICAgICAgIC8vY3R4LmZvbnQgPSBcIml0YWxpYyAxNHB4IEFyaWFsXCI7XG4gICAgICAgICAgLy9jdHguZm9udCA9IFwiaXRhbGljIFwiICsgTWF0aC5tYXgoTWF0aC5mbG9vcihwdy8yKSwgMTIpICsgXCJweCBBcmlhbFwiO1xuICAgICAgICAgIGN0eC5mb250ID0gXCJpdGFsaWMgXCIgKyBNYXRoLm1heChNYXRoLmZsb29yKHB3LzEuNSksIDEyKSArIFwicHggQXJpYWxcIjtcbiAgICAgICAgICBsZXQgZncgPSBjdHgubWVhc3VyZVRleHQocy5uYW1lKS53aWR0aCxcbiAgICAgICAgICAgICAgZmggPSBwYXJzZUludChjdHguZm9udCk7XG4gICAgICAgICAgLypyeCA9IHJ4IC0gZncqMC41IDwgMD8gZncqMC41OiBcbiAgICAgICAgICAgICAgIChyeCArIGZ3KjAuNSA+PSBjYW52YXMud2lkdGg/IGNhbnZhcy53aWR0aCAtIGZ3KjAuNSA6IHJ4KSxcbiAgICAgICAgICByeSA9IHJ5IC0gZmgqMC41IDwgMD8gZmgqMC41OiBcbiAgICAgICAgICAgICAgIChyeSArIGZoKjAuNSA+PSBjYW52YXMuaGVpZ2h0PyBjYW52YXMuaGVpZ2h0IC0gZmgqMC41IDogcnkpOyovXG4gICAgICAgICAgLy9jdHgubGluZVdpZHRoID0gNTtcbiAgICAgICAgICAvL2N0eC5zdHJva2VUZXh0KHMubmFtZSwgcngsIHJ5KTtcbiAgICAgICAgICBjdHguZmlsbFRleHQocy5uYW1lLCByeCwgcnkpO1xuICAgICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNTtcbiAgICAgICAgICBjdHguZmlsbFRleHQocy5uYW1lLCByeCwgcnkpO1xuICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICB9XG4gICAgfVxuICAgIGZyYW1lX2luZGV4ICs9IDE7XG4gIH0oKSk7XG4gIHJldHVybiAoKT0+e1xuICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKGZyYW1lKTtcbiAgfVxufSk7XG5vbkRlc3Ryb3koKCk9PntcbiAgaWYoZnJhbWUpIHtcbiAgICBjYW5jZWxBbmltYXRpb25GcmFtZShmcmFtZSk7XG4gICAgZnJhbWUgPSBudWxsO1xuICB9XG59KTtcbi8qXG4gICAgICAgIGxldCBmaCA9IHBhcnNlSW50KGN0eC5mb250KTtcbiAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMC43O1xuICAgICAgICBjdHguZmlsbFN0eWxlID0gXCIjZmZmXCI7XG4gICAgICAgIGN0eC5maWxsUmVjdChweCArIGJvcmRlcl93aWR0aCwgcHkrcGggLSBib3JkZXJfd2lkdGggLSBmaCwgcHcgLSAyKmJvcmRlcl93aWR0aCwgZmgpO1xuICAgICAgICBjdHguZ2xvYmFsQWxwaGEgPSAxLjA7XG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIiMwMDBcIjtcbiAgICAgICAgY3R4LmZpbGxUZXh0KHMubmFtZSwgcHggKyBib3JkZXJfd2lkdGgqMC41LCBweSArIHBoIC0gYm9yZGVyX3dpZHRoIC0gZmgpO1xuICAgICAgfVxuICAgIH1cbiAgfSgpKTtcbiAgcmV0dXJuICgpPT57XG4gICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUoZnJhbWUpO1xuICB9XG59KTtcbiovXG48L3NjcmlwdD5cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFRRSxNQUFNLGNBQUMsQ0FBQyxBQUNOLFFBQVEsQ0FBRSxLQUFLLENBQ2YsT0FBTyxDQUFFLElBQUksQ0FDYixHQUFHLENBQUUsQ0FBQyxDQUNOLE1BQU0sQ0FBRSxLQUFLLENBQ2IsS0FBSyxDQUFFLEtBQUssQ0FDWixlQUFlLENBQUUsTUFBTSxDQUN2QixXQUFXLENBQUUsTUFBTSxDQUNuQixPQUFPLENBQUUsSUFBSSxDQUNiLE9BQU8sQ0FBRSxDQUFDLENBQ1YsZ0JBQWdCLENBQUUsU0FBUyxDQUMzQixVQUFVLENBQUUsTUFBTSxDQUNsQixVQUFVLENBQUUsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsUUFBUSxBQUNuRCxDQUFDLEFBQ08sV0FBVyxBQUFFLENBQUMsQUFDcEIsVUFBVSxDQUFFLE9BQU8sQ0FDbkIsT0FBTyxDQUFFLEdBQUcsQUFDZCxDQUFDLEFBQ0QsVUFBVSxjQUFDLENBQUMsQUFDVixLQUFLLENBQUUsV0FBVyxDQUNsQixTQUFTLENBQUUsS0FBSyxBQUNsQixDQUFDO0FDdUZILGlCQUFpQixZQUFDLENBQUMsQUFDakIsS0FBSyxDQUFFLElBQUksQ0FDWCxNQUFNLENBQUUsS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUM3QixVQUFVLENBQUUsTUFBTSxDQUNsQixnQkFBZ0IsQ0FBRSxPQUFPLEFBRTNCLENBQUMsQUFDRCxPQUFPLFlBQUMsQ0FBQyxBQUlULENBQUMifQ== */